# Render.com deployment configuration
# Docs: https://render.com/docs/yaml-spec

services:
  - type: web
    name: lotus-kindergarten
    runtime: node
    plan: free          # Change to "starter" ($7/mo) for always-on
    region: singapore   # Change to: oregon | frankfurt | ohio | virginia

    buildCommand: npm run build   # runs: cd server && npm install
    startCommand: npm start       # runs: node server/server.js

    # Health check
    healthCheckPath: /api/health

    envVars:
      - key: NODE_ENV
        value: production

      # ── Required ─────────────────────────────────────────────────────────
      - key: DATABASE_URI
        sync: false          # Set this in the Render dashboard (never commit)

      - key: JWT_SECRET
        generateValue: true  # Render auto-generates a secure random string

      - key: JWT_EXPIRES_IN
        value: 90d

      - key: JWT_COOKIE_EXPIRES_IN
        value: 90

      # ── CORS ─────────────────────────────────────────────────────────────
      # Render sets the service URL automatically via RENDER_EXTERNAL_URL.
      # We use that as the allowed CORS origin.
      - key: FRONTEND_URL
        fromService:
          type: web
          name: lotus-kindergarten
          property: host

      # ── Optional ─────────────────────────────────────────────────────────
      # Add EMAIL_* and CLOUDINARY_* here if you need them
